<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ResQWings | Autonomous Drone Coordination</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    <script src="https://unpkg.com/feather-icons"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <style>
        #map {
            height: 70vh;
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% {
                opacity: 0.8;
            }

            50% {
                opacity: 0.4;
            }

            100% {
                opacity: 0.8;
            }
        }

        .search-pattern {
            stroke-dasharray: 1000;
            stroke-dashoffset: 1000;
            animation: dash 30s linear forwards;
        }

        @keyframes dash {
            to {
                stroke-dashoffset: 0;
            }
        }
    </style>
</head>

<body class="bg-gray-900 text-gray-100">
    <header class="bg-black bg-opacity-80 backdrop-blur-sm fixed w-full z-50">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <div class="flex items-center space-x-2">
                <img src="https://opkrn.github.io/RESQWINGS/logoRq.png" alt="ResQwings Logo"
                    style="height:64px; width:auto; object-fit:contain; background:transparent;" />
                <h1
                    class="text-xl font-bold bg-gradient-to-r from-emerald-400 to-blue-400 bg-clip-text text-transparent">
                    ResQWings</h1>
            </div>
            <nav class="flex space-x-6">
                <button class="tab-btn hover:text-emerald-400 transition" data-tab="dashboard">Dashboard</button>
                <button class="tab-btn hover:text-emerald-400 transition" data-tab="mission">Mission Control</button>
                <!-- <button class="tab-btn hover:text-emerald-400 transition" data-tab="simulation">Simulation</button> -->
            </nav>
        </div>
    </header>

    <main class="pt-20 pb-16">
        <!-- Dashboard Section -->
        <section id="dashboard-section" class="tab-section container mx-auto px-4 py-12">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
                <div data-aos="fade-right">
                    <h2 class="text-4xl md:text-5xl font-bold mb-6">Autonomous Swarm <span
                            class="text-emerald-400">Rescue Operations</span></h2>
                    <p class="text-lg text-gray-300 mb-8">Define the search area and let our AI-powered drone swarm
                        autonomously coordinate, search, and guide survivors to safety with minimal human intervention.</p>
                    <div class="flex flex-wrap gap-4">
                        <button id="launch-mission-btn"
                            class="bg-emerald-500 hover:bg-emerald-600 text-white px-6 py-3 rounded-lg font-medium transition flex items-center gap-2">
                            <i data-feather="play"></i> Launch New Mission
                        </button>
                        <!-- Connect to AirSim button hidden -->
                    </div>
                </div>
                <div data-aos="fade-left" class="relative">
                    <div class="bg-gray-800 rounded-xl p-1 shadow-2xl shadow-emerald-400/10">
                        <div id="map" class="rounded-lg"></div>
                    </div>
                    <!-- <div
                        class="absolute -bottom-4 -right-4 bg-emerald-500 text-black px-3 py-1 rounded-full text-sm font-bold">
                        LIVE SIMULATION
                    </div> -->
                </div>
            </div>
        </section>

        <!-- Mission Control Section -->
        <section id="mission-section" class="tab-section container mx-auto px-4 py-12 hidden">
            <div class="max-w-6xl mx-auto bg-gradient-to-br from-gray-900 via-emerald-900/60 to-gray-900 rounded-2xl shadow-2xl flex flex-col md:flex-row overflow-hidden">
                <div class="w-full md:w-1/3 bg-gradient-to-br from-gray-900 via-emerald-900/40 to-gray-900 p-8 flex flex-col gap-8" style="min-width:320px;">
                    <div class="flex items-center gap-3 mb-4">
                        <div class="bg-black rounded-full w-12 h-12 flex items-center justify-center shadow-lg animate-pulse">
                            <img src="https://opkrn.github.io/RESQWINGS/logoRq.png" alt="ResQWings Logo" class="h-8 w-8 object-contain glow-logo" />
                        </div>
<style>
    .glow-logo {
        filter: drop-shadow(0 0 8px #10b981) drop-shadow(0 0 16px #10b981);
        animation: glow-pulse 1.5s infinite alternate;
    }
    @keyframes glow-pulse {
        0% { filter: drop-shadow(0 0 8px #10b981) drop-shadow(0 0 16px #10b981); }
        100% { filter: drop-shadow(0 0 16px #34d399) drop-shadow(0 0 32px #10b981); }
    }
</style>
                        <span class="text-2xl font-bold text-emerald-400 tracking-tight">ResQWings</span>
                    </div>
                    <div class="bg-gray-900/80 rounded-xl p-6 shadow flex flex-col gap-4 border border-emerald-900/20">
                        <div class="flex items-center gap-2 mb-2">
                            <svg width="20" height="20" fill="none" viewBox="0 0 20 20"><circle cx="10" cy="10" r="9" stroke="#10b981" stroke-width="2" fill="#10b981" opacity="0.15"/><rect x="6" y="9" width="8" height="2" rx="1" fill="#10b981"/><rect x="9" y="6" width="2" height="8" rx="1" fill="#10b981"/></svg>
                            <h2 class="text-lg font-semibold text-white">Mission Parameters</h2>
                        </div>
                        <input id="search" type="text" placeholder="Enter city / area / locality" class="w-full bg-gray-800 border border-emerald-700 rounded-lg px-3 py-2 text-sm text-white mb-2 focus:outline-none focus:ring-2 focus:ring-emerald-500">
                        <div id="suggestions" class="bg-gray-800 border border-emerald-700 rounded-lg text-sm text-white absolute z-20 w-full" style="display:none;"></div>
                        <label for="drone-count" class="block text-sm font-medium text-emerald-300 mb-1 mt-2">Number of Drones</label>
                        <select id="drone-count" class="w-full bg-gray-800 border border-emerald-700 rounded-lg px-3 py-2 text-sm text-white mb-2 focus:outline-none focus:ring-2 focus:ring-emerald-500">
                            <!-- Options will be populated by JS for 1-100 -->
                        </select>
                        <button id="searchBtn" class="w-full bg-emerald-500 hover:bg-emerald-600 text-white py-2 rounded-lg font-semibold mb-2 flex items-center justify-center gap-2"><span>üîç</span>Search</button>
                        <div id="controls"></div>
                    </div>
                    <div class="bg-gray-900/80 rounded-xl p-6 shadow flex flex-col gap-4 border border-emerald-900/20">
                        <div class="flex items-center gap-2 mb-2">
                            <svg width="20" height="20" fill="none" viewBox="0 0 20 20"><circle cx="10" cy="10" r="9" stroke="#10b981" stroke-width="2" fill="#10b981" opacity="0.15"/><rect x="6" y="9" width="8" height="2" rx="1" fill="#10b981"/><rect x="9" y="6" width="2" height="8" rx="1" fill="#10b981"/></svg>
                            <h2 class="text-lg font-semibold text-white">Swarm Status</h2>
                        </div>
                        <div class="grid grid-cols-2 gap-3 text-sm">
                            <div class="flex items-center gap-2 bg-gray-800/80 rounded-lg px-3 py-2">
                                <span class="inline-block w-2 h-2 bg-emerald-400 rounded-full"></span> Active Drones
                                <span class="ml-auto font-bold text-emerald-300" id="active-drones-count">1/1</span>
                            </div>
                            <div class="flex items-center gap-2 bg-gray-800/80 rounded-lg px-3 py-2">
                                <svg width="14" height="14" fill="none" viewBox="0 0 14 14"><circle cx="7" cy="7" r="6" stroke="#10b981" stroke-width="2" opacity="0.5"/><rect x="4" y="6" width="6" height="2" rx="1" fill="#10b981"/></svg> Avg Battery
                                <span class="ml-auto font-bold text-emerald-300">84%</span>
                            </div>
                            <div class="flex items-center gap-2 bg-gray-800/80 rounded-lg px-3 py-2">
                                <svg width="14" height="14" fill="none" viewBox="0 0 14 14"><circle cx="7" cy="7" r="6" stroke="#10b981" stroke-width="2" opacity="0.5"/><rect x="6" y="4" width="2" height="6" rx="1" fill="#10b981"/></svg> Latency
                                <span class="ml-auto font-bold text-emerald-300">28ms</span>
                            </div>
                            <div class="flex items-center gap-2 bg-gray-800/80 rounded-lg px-3 py-2">
                                <svg width="14" height="14" fill="none" viewBox="0 0 14 14"><circle cx="7" cy="7" r="6" stroke="#10b981" stroke-width="2" opacity="0.5"/><rect x="4" y="6" width="6" height="2" rx="1" fill="#10b981"/></svg> Area Covered
                                <span class="ml-auto font-bold text-emerald-300">37%</span>
                            </div>
                        </div>
                    </div>
                                </div>
                <div class="w-full md:w-2/3 relative flex items-center justify-center" style="min-height:500px;">
                    <div id="mission-map" class="rounded-2xl shadow-2xl border-2 border-emerald-900/20 bg-gray-900 absolute inset-0" style="height:100%; min-height:500px;"></div>
                </div>
            </div>
        </section>

        <!-- Simulation Section -->
        <section id="simulation-section" class="tab-section container mx-auto px-4 py-12 hidden">
            <!-- Simulation content from simulation.html goes here (simulation controls, video feed, etc.) -->
            <iframe src="simulation.html" style="width:100%;height:80vh;border:none;"></iframe>
        </section>

        <section class="bg-gray-800 py-16">
        <!-- Drone's Details Section -->
        <section class="container mx-auto px-4 py-16">
            <div class="relative bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 rounded-2xl shadow-2xl overflow-hidden p-0 md:p-8 mb-12" data-aos="fade-up">
                <div class="absolute inset-0 pointer-events-none select-none" style="background: radial-gradient(circle at 70% 30%, rgba(16,185,129,0.10) 0%, transparent 70%), radial-gradient(circle at 20% 80%, rgba(16,185,129,0.08) 0%, transparent 70%);"></div>
                <div class="relative z-10 flex flex-col items-center gap-6 p-6 md:p-10">
                    <div class="flex flex-col items-center gap-2">
                        <div class="bg-gradient-to-tr from-emerald-500/80 to-emerald-400/60 rounded-full w-16 h-16 flex items-center justify-center shadow-lg animate-pulse">
                            <svg width="36" height="36" fill="none" viewBox="0 0 36 36"><circle cx="18" cy="18" r="16" stroke="#10b981" stroke-width="2" fill="#10b981" opacity="0.15"/><rect x="10" y="16" width="16" height="4" rx="2" fill="#10b981"/><rect x="16" y="10" width="4" height="16" rx="2" fill="#10b981"/></svg>
                        </div>
                        <h2 class="text-3xl font-bold text-emerald-400 mb-2 text-center">Drone's Details</h2>
                    </div>
                    <div class="w-full overflow-x-auto">
                        <table class="min-w-full text-sm text-left text-gray-300 rounded-xl overflow-hidden shadow-lg">
                            <thead class="bg-gray-900 text-emerald-400">
                                <tr>
                                    <th class="px-6 py-3">Drone ID</th>
                                    <th class="px-6 py-3">Battery (%)</th>
                                    <th class="px-6 py-3">Efficiency</th>
                                    <th class="px-6 py-3">Area Covered (m¬≤)</th>
                                </tr>
                            </thead>
                            <tbody id="drone-details-table" class="bg-gray-800/80">
                                <!-- Populated by JS -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
                        <!-- Swarm Conversation Section -->
            <section class="container mx-auto px-4 py-16">
                <div class="relative bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 rounded-2xl shadow-2xl overflow-hidden p-0 md:p-8" data-aos="fade-up">
                    <div class="absolute inset-0 pointer-events-none select-none" style="background: radial-gradient(circle at 60% 20%, rgba(16,185,129,0.10) 0%, transparent 70%), radial-gradient(circle at 10% 90%, rgba(16,185,129,0.08) 0%, transparent 70%);"></div>
                    <div class="relative z-10 flex flex-col items-center gap-6 p-6 md:p-10">
                        <div class="flex flex-col items-center gap-2">
                            <div class="bg-gradient-to-tr from-emerald-500/80 to-emerald-400/60 rounded-full w-16 h-16 flex items-center justify-center shadow-lg animate-pulse">
                                <svg width="36" height="36" fill="none" viewBox="0 0 36 36"><circle cx="18" cy="18" r="16" stroke="#10b981" stroke-width="2" fill="#10b981" opacity="0.15"/><rect x="10" y="16" width="16" height="4" rx="2" fill="#10b981"/><rect x="16" y="10" width="4" height="16" rx="2" fill="#10b981"/></svg>
                            </div>
                            <h2 class="text-3xl font-bold text-emerald-400 mb-2 text-center">Drone's Communication</h2>
                        </div>
                        <div class="w-full">
                            <pre class="bg-gray-800 text-emerald-300 rounded-lg p-4 h-24 md:h-32 text-sm md:text-base leading-none whitespace-pre overflow-hidden shadow-inner border border-emerald-900/30"><code id="swarm-binary-code"></code></pre>
                        </div>
                    </div>
                </div>
                        </section>
        </section>

        <section class="container mx-auto px-4 py-16">
            <h2 class="text-4xl font-extrabold mb-10 text-center text-emerald-400 tracking-tight" data-aos="fade-up">Mission Dashboard</h2>
            <div class="relative bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 rounded-2xl shadow-2xl overflow-hidden p-0 md:p-8" data-aos="fade-up">
                <div class="absolute inset-0 pointer-events-none select-none" style="background: radial-gradient(circle at 70% 30%, rgba(16,185,129,0.12) 0%, transparent 70%), radial-gradient(circle at 20% 80%, rgba(16,185,129,0.10) 0%, transparent 70%);"></div>
                <div class="relative z-10 grid grid-cols-1 md:grid-cols-3 gap-8 p-6 md:p-10">
                    <!-- Mission Summary -->
                    <div class="flex flex-col gap-4 justify-center items-center text-center">
                        <div class="bg-gradient-to-tr from-emerald-500/80 to-emerald-400/60 rounded-full w-20 h-20 flex items-center justify-center shadow-lg mb-2 animate-pulse">
                            <svg width="48" height="48" fill="none" viewBox="0 0 48 48"><circle cx="24" cy="24" r="22" stroke="#fff" stroke-width="2" fill="#10b981" opacity="0.2"/><path d="M24 12l6 12h-12l6-12zm0 24a2 2 0 100-4 2 2 0 000 4z" fill="#10b981"/><path d="M24 12l6 12h-12l6-12z" stroke="#fff" stroke-width="2"/></svg>
                        </div>
                        <h3 class="text-xl font-bold text-white">Operation Cyclone</h3>
                        <p class="text-gray-300 text-sm">Coordinated search and rescue mission in the designated area. Drones are actively scanning and reporting real-time data.</p>
                        <div class="flex flex-wrap gap-2 justify-center mt-2">
                            <span class="bg-emerald-600/80 text-white text-xs px-3 py-1 rounded-full">Active</span>
                            <span class="bg-gray-700 text-emerald-300 text-xs px-3 py-1 rounded-full">AI Swarm</span>
                        </div>
                    </div>
                    <!-- Stats -->
                    <div class="flex flex-col gap-6 justify-center">
                        <div class="flex items-center gap-4 bg-gray-800/80 rounded-xl p-4 shadow border border-emerald-900/30">
                            <div class="bg-emerald-500/20 rounded-full p-3">
                                <svg width="28" height="28" fill="none" viewBox="0 0 28 28"><circle cx="14" cy="14" r="12" stroke="#10b981" stroke-width="2"/><path d="M14 6v8l6 4" stroke="#10b981" stroke-width="2" stroke-linecap="round"/></svg>
                            </div>
                            <div>
                                <div class="text-gray-400 text-xs">AREA COVERED</div>
                                <div class="text-3xl font-extrabold text-emerald-400">42<span class="text-base">%</span></div>
                            </div>
                        </div>
                        <div class="flex items-center gap-4 bg-gray-800/80 rounded-xl p-4 shadow border border-emerald-900/30">
                            <div class="bg-emerald-500/20 rounded-full p-3">
                                <svg width="28" height="28" fill="none" viewBox="0 0 28 28"><rect x="6" y="12" width="16" height="8" rx="2" fill="#10b981"/><rect x="10" y="8" width="8" height="8" rx="2" fill="#34d399"/></svg>
                            </div>
                            <div>
                                <div class="text-gray-400 text-xs">DETECTIONS</div>
                                <div class="text-3xl font-extrabold text-emerald-400">3</div>
                            </div>
                        </div>
                        <div class="flex items-center gap-4 bg-gray-800/80 rounded-xl p-4 shadow border border-emerald-900/30">
                            <div class="bg-emerald-500/20 rounded-full p-3">
                                <svg width="28" height="28" fill="none" viewBox="0 0 28 28"><circle cx="14" cy="14" r="12" stroke="#10b981" stroke-width="2"/><path d="M14 8v6l4 2" stroke="#10b981" stroke-width="2" stroke-linecap="round"/></svg>
                            </div>
                            <div>
                                <div class="text-gray-400 text-xs">TIME ELAPSED</div>
                                <div class="text-3xl font-extrabold text-emerald-400">18:42</div>
                            </div>
                        </div>
                    </div>
                    <!-- Activity Feed -->
                    <div class="flex flex-col gap-4 justify-center">
                        <div class="bg-gradient-to-tr from-emerald-900/40 to-gray-900/80 rounded-lg p-3 text-xs text-gray-200 shadow-inner border border-emerald-900/30">
                            <div class="mb-1 flex items-center gap-2"><span class="inline-block w-2 h-2 bg-emerald-400 rounded-full"></span> Drone 01: Area scan complete</div>
                            <div class="mb-1 flex items-center gap-2"><span class="inline-block w-2 h-2 bg-emerald-400 rounded-full"></span> Drone 02: Survivor detected</div>
                            <div class="mb-1 flex items-center gap-2"><span class="inline-block w-2 h-2 bg-emerald-400 rounded-full"></span> Drone 03: Battery low</div>
                            <div class="flex items-center gap-2"><span class="inline-block w-2 h-2 bg-gray-400 rounded-full"></span> Swarm: Awaiting new command...</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <script>

        // Fill the Swarm Conversation code block with animated 0s and 1s, filling the whole space
        document.addEventListener('DOMContentLoaded', function() {
            const binBlock = document.getElementById('swarm-binary-code');
            if (binBlock) {
                let binStr = '';
                function getDims() {
                    const style = window.getComputedStyle(binBlock.parentElement);
                    const height = binBlock.parentElement.offsetHeight;
                    const fontSize = parseFloat(style.fontSize);
                    const lineHeight = parseFloat(style.lineHeight) || fontSize * 1.1;
                    const lines = Math.floor(height / lineHeight);
                    const width = binBlock.parentElement.offsetWidth;
                    const charsPerLine = Math.floor(width / (fontSize * 0.6));
                    return { lines, charsPerLine };
                }
                function renderBinary() {
                    const { lines, charsPerLine } = getDims();
                    const totalChars = lines * charsPerLine;
                    // Shift the binary string left by a few chars to create a moving effect
                    const shift = Math.max(1, Math.floor(charsPerLine * 0.1));
                    binStr = binStr.slice(shift);
                    while (binStr.length < totalChars) {
                        binStr += Math.random() > 0.6 ? '1' : '0';
                    }
                    if (binStr.length > totalChars) binStr = binStr.slice(-totalChars);
                    let out = '';
                    for (let i = 0; i < binStr.length; i += charsPerLine) {
                        out += binStr.slice(i, i + charsPerLine) + '\n';
                    }
                    binBlock.textContent = out;
                }
                setInterval(renderBinary, 180); // slower update interval
                window.addEventListener('resize', renderBinary);
            }
        });

        // Generate drone details for a given count
        function generateDroneDetails(count) {
            const drones = [];
            for (let i = 1; i <= count; i++) {
                drones.push({
                    id: `DRONE-${String(i).padStart(2, '0')}`,
                    battery: Math.floor(70 + Math.random() * 30),
                    efficiency: `${90 + Math.floor(Math.random() * 10)}%`,
                    area: 280 + Math.floor(Math.random() * 50)
                });
            }
            return drones;
        }

        // Render drone details table
        function renderDroneDetails(count) {
            const table = document.getElementById('drone-details-table');
            if (table) {
                const drones = generateDroneDetails(count);
                table.innerHTML = drones.map(drone => `
                    <tr class="border-b border-gray-700 hover:bg-gray-700/30">
                        <td class="px-6 py-4 font-medium text-white">${drone.id}</td>
                        <td class="px-6 py-4">${drone.battery}%</td>
                        <td class="px-6 py-4">${drone.efficiency}</td>
                        <td class="px-6 py-4">${drone.area}</td>
                    </tr>
                `).join('');
            }
        }

        document.addEventListener('DOMContentLoaded', function() {
            const droneCount = document.getElementById('drone-count');
            // Populate drone count dropdown (1-100) if not already populated
            if (droneCount && droneCount.options.length < 100) {
                droneCount.innerHTML = '';
                for (let i = 1; i <= 100; i++) {
                    const opt = document.createElement('option');
                    opt.value = i;
                    opt.textContent = i;
                    droneCount.appendChild(opt);
                }
            }
            let count = 5;
            if (droneCount) {
                count = parseInt(droneCount.value) || 5;
                droneCount.addEventListener('change', function() {
                    renderDroneDetails(parseInt(this.value));
                });
            }
            renderDroneDetails(count);
        });


        // Populate drone count dropdown (1-100)
        document.addEventListener('DOMContentLoaded', function() {
            const droneCount = document.getElementById('drone-count');
            if (droneCount) {
                for (let i = 1; i <= 100; i++) {
                    const opt = document.createElement('option');
                    opt.value = i;
                    opt.textContent = i;
                    droneCount.appendChild(opt);
                }
            }
        });

        AOS.init();
        feather.replace();
        // Tab switching logic
        const tabBtns = document.querySelectorAll('.tab-btn');
        const tabSections = document.querySelectorAll('.tab-section');
        tabBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                tabSections.forEach(sec => sec.classList.add('hidden'));
                document.getElementById(`${btn.dataset.tab}-section`).classList.remove('hidden');
            });
        });

        // Dashboard action buttons
        document.getElementById('launch-mission-btn').onclick = () => {
            tabSections.forEach(sec => sec.classList.add('hidden'));
            document.getElementById('mission-section').classList.remove('hidden');
            setTimeout(() => {
                if (window.missionMap) {
                    window.missionMap.invalidateSize();
                }
            }, 300);
        };

        // Also handle tab switching to Mission Control
        document.querySelectorAll('.tab-btn[data-tab="mission"]').forEach(btn => {
            btn.addEventListener('click', () => {
                setTimeout(() => {
                    if (window.missionMap) {
                        window.missionMap.invalidateSize();
                    }
                }, 300);
            });
        });

        // Dashboard map
        if (document.getElementById('map')) {
            const map = L.map('map').setView([22.5726, 88.3639], 13);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
            }).addTo(map);
            // Draw a green circle instead of polygon
            const circle = L.circle([22.5726, 88.3639], {
                color: 'red',
                fillColor: 'red',
                fillOpacity: 0.15,
                radius: 1200
            }).addTo(map);
            const droneIcon = L.divIcon({
                html: `<svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <g>
                        <rect x="14" y="6" width="4" height="20" rx="2" fill="#10b981"/>
                        <rect x="6" y="14" width="20" height="4" rx="2" fill="#10b981"/>
                        <circle cx="16" cy="16" r="4" fill="#059669" stroke="#10b981" stroke-width="2"/>
                    </g>
                </svg>`,
                className: '',
                iconSize: [32, 32]
            });
            const drones = [
                { id: 'DRONE-01', lat: 22.5726, lng: 88.3639, battery: 87 },
                { id: 'DRONE-02', lat: 22.5740, lng: 88.3680, battery: 92 },
                { id: 'DRONE-03', lat: 22.5700, lng: 88.3600, battery: 78 },
                { id: 'DRONE-04', lat: 22.5760, lng: 88.3660, battery: 85 },
                { id: 'DRONE-05', lat: 22.5733, lng: 88.3650, battery: 90 }
            ];
            const markers = [];
            drones.forEach(drone => {
                const marker = L.marker([drone.lat, drone.lng], { icon: droneIcon })
                    .addTo(map)
                    .bindPopup(`<b>${drone.id}</b><br>Battery: ${drone.battery}%`);
                markers.push(marker);
            });
            setInterval(() => {
                // Animate 5 drones in realistic spiral scan paths within the circle
                const center = [22.5726, 88.3639];
                const radius = 0.012;
                const droneCount = drones.length;
                let t = (window._droneT = (window._droneT || 0) + 0.003);
                for (let i = 0; i < droneCount; i++) {
                    // Each drone starts at a different phase
                    let phase = (i / droneCount) * 2 * Math.PI;
                    // Spiral out and in
                    let spiral = 0.2 + 0.7 * (0.5 + 0.5 * Math.sin(t + i));
                    let angle = t * 2 * Math.PI + phase;
                    let lat = center[0] + spiral * radius * Math.cos(angle);
                    let lng = center[1] + spiral * radius * Math.sin(angle);
                    markers[i].setLatLng([lat, lng]);
                }
                if (window._droneT > 100) window._droneT = 0;
            }, 50);
        }

        // Mission Control map (robust, resizes on tab switch)
        if (document.getElementById('mission-map')) {
            // Only initialize once
            if (!window.missionMap) {
                window.missionMap = L.map('mission-map', { zoomControl: true }).setView([22.5726, 88.3639], 13);
                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
                }).addTo(window.missionMap);
                // Draw a red circle for the mission area
                window.missionCircle = L.circle([22.5726, 88.3639], {
                    color: 'red',
                    fillColor: 'red',
                    fillOpacity: 0.15,
                    radius: 1200
                }).addTo(window.missionMap);

                // Area selection (draw rectangle inside the red circle)
                window.selectedArea = null;
                window.areaLayer = null;
                window.missionMap.on('click', function(e) {
                    // Centered on click, fixed size rectangle for demo (could be improved)
                    const center = [e.latlng.lat, e.latlng.lng];
                    const bounds = [
                        [center[0] - 0.003, center[1] - 0.003],
                        [center[0] + 0.003, center[1] + 0.003]
                    ];
                    if (window.areaLayer) window.missionMap.removeLayer(window.areaLayer);
                    window.areaLayer = L.rectangle(bounds, {color: '#10b981', weight: 2, fillOpacity: 0.2}).addTo(window.missionMap);
                    window.selectedArea = bounds;
                });

                // Drones
                const missionDroneIcon = L.divIcon({
                    html: `<svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <g>
                            <rect x="14" y="6" width="4" height="20" rx="2" fill="#10b981"/>
                            <rect x="6" y="14" width="20" height="4" rx="2" fill="#10b981"/>
                            <circle cx="16" cy="16" r="4" fill="#059669" stroke="#10b981" stroke-width="2"/>
                        </g>
                    </svg>`,
                    className: '',
                    iconSize: [32, 32]
                });

                function updateMissionDrones(count) {
                    // Remove old markers
                    if (window.missionMarkers) {
                        window.missionMarkers.forEach(m => window.missionMap.removeLayer(m));
                    }
                    window.missionDrones = [];
                    window.missionMarkers = [];
                    for (let i = 0; i < count; i++) {
                        window.missionDrones.push({
                            id: `DRONE-${(i+1).toString().padStart(2,'0')}`,
                            lat: 22.5726,
                            lng: 88.3639,
                            battery: 80 + Math.floor(Math.random()*20)
                        });
                        const marker = L.marker([22.5726, 88.3639], { icon: missionDroneIcon })
                            .addTo(window.missionMap)
                            .bindPopup(`<b>DRONE-${(i+1).toString().padStart(2,'0')}</b><br>Battery: ${window.missionDrones[i].battery}%`);
                        window.missionMarkers.push(marker);
                    }
                }

                // Initial drone count from dropdown
                let initialCount = 5;
                const droneCountSel = document.getElementById('drone-count');
                if (droneCountSel) {
                    initialCount = parseInt(droneCountSel.value) || 5;
                    droneCountSel.addEventListener('change', function() {
                        updateMissionDrones(parseInt(this.value));
                    });
                }
                updateMissionDrones(initialCount);

                setInterval(() => {
                    // Animate drones: each scans a unique vertical strip of the selected area, moving top to bottom
                    if (window._dronesStopped) return;
                    const droneCount2 = window.missionDrones.length;
                    let t2 = (window._droneT2 = (window._droneT2 || 0) + 0.003);
                    let area = window.selectedArea || [[22.5696, 88.3609], [22.5756, 88.3669]]; // fallback area
                    const [[latMin, lngMin], [latMax, lngMax]] = area;
                    let allDone = true;
                    // All drones use the same frac, so they move in sync
                    let frac = t2;
                    if (frac < 1) allDone = false;
                    for (let i = 0; i < droneCount2; i++) {
                        // Partition area into vertical strips
                        let stripWidth = (lngMax - lngMin) / droneCount2;
                        let x0 = lngMin + i * stripWidth;
                        let x1 = x0 + stripWidth;
                        // Drone moves vertically from top to bottom in its strip
                        let lat = latMax - Math.min(frac, 1) * (latMax - latMin);
                        let lng = (x0 + x1) / 2;
                        // Constrain to mission circle if needed
                        const center2 = [22.5726, 88.3639];
                        const circleRadius = 0.012;
                        let dLat = lat - center2[0];
                        let dLng = lng - center2[1];
                        let dist = Math.sqrt(dLat * dLat + dLng * dLng);
                        if (dist > circleRadius) {
                            // Project point onto circle boundary
                            lat = center2[0] + (dLat / dist) * circleRadius;
                            lng = center2[1] + (dLng / dist) * circleRadius;
                        }
                        window.missionMarkers[i].setLatLng([lat, lng]);
                    }
                    // Update Swarm Status panel
                    // Active drones
                    const activeDrones = droneCount2;
                    const activeDronesCountEl = document.getElementById('active-drones-count');
                    if (activeDronesCountEl) {
                        activeDronesCountEl.textContent = `${activeDrones}/${droneCount2}`;
                    }
                    // Area covered (percent)
                    const areaCovered = Math.round(Math.min(frac, 1) * 100);
                    const areaCoveredEls = Array.from(document.querySelectorAll('span')).filter(e => e.textContent && e.textContent.includes('%') && e.textContent.includes('Area Covered'));
                    // Try to update the correct area covered element in Swarm Status
                    const areaCoveredEl = document.querySelector('#mission-section span:contains("Area Covered") + span');
                    if (areaCoveredEl) {
                        areaCoveredEl.textContent = `${areaCovered}%`;
                    } else {
                        // fallback: update all area covered spans
                        document.querySelectorAll('#mission-section span').forEach(span => {
                            if (span.textContent.match(/^\d+%$/)) span.textContent = `${areaCovered}%`;
                        });
                    }
                    // Time elapsed
                    if (!window._scanStartTime) window._scanStartTime = Date.now();
                    let elapsed = window._dronesStopped ? window._scanEndTime || (window._scanEndTime = Date.now()) : Date.now();
                    let seconds = Math.floor(((elapsed - window._scanStartTime) / 1000));
                    let min = Math.floor(seconds / 60);
                    let sec = seconds % 60;
                    const timeStr = `${min}:${sec.toString().padStart(2, '0')}`;
                    // Try to update the correct time elapsed element in Swarm Status
                    const timeEls = Array.from(document.querySelectorAll('#mission-section span')).filter(e => e.textContent && e.textContent.match(/^\d+:\d\d$/));
                    if (timeEls.length) {
                        timeEls[0].textContent = timeStr;
                    }
                    if (allDone) window._dronesStopped = true;
                    if (window._droneT2 > 1) window._droneT2 = 1;
                }, 50);
                // Reset drone movement when area or drone count changes
                function resetDroneScan() {
                    window._droneT2 = 0;
                    window._dronesStopped = false;
                    window._scanStartTime = Date.now();
                    window._scanEndTime = null;
                }
                if (droneCountSel) {
                    droneCountSel.addEventListener('change', function() {
                        updateMissionDrones(parseInt(this.value));
                        resetDroneScan();
                    });
                }
                window.missionMap.on('click', function(e) {
                    // ...existing code...
                    resetDroneScan();
                });
            }
        }

    </script>
    <script src="app.js"></script>

        <footer class="bg-gradient-to-r from-gray-900 via-emerald-900 to-gray-900 py-10 mt-12 border-t border-emerald-800">
            <div class="container mx-auto px-4 grid grid-cols-1 md:grid-cols-4 gap-12 items-start border-b border-emerald-800 pb-8">
                <!-- Contact Info -->
                <div class="flex flex-col gap-2 min-w-[180px] md:order-1 order-2">
                    <span class="text-emerald-400 font-bold uppercase tracking-wide mb-2 text-xs">Contact</span>
                    <span class="flex items-center gap-2 text-gray-300"><svg class="h-4 w-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M16 2v6a2 2 0 002 2h6"/><rect x="2" y="2" width="20" height="20" rx="5"/></svg>info@resqwings.com</span>
                    <span class="flex items-center gap-2 text-gray-300"><svg class="h-4 w-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M3 5h18M3 12h18M3 19h18"/></svg>+91 82409 47366</span>
                    <span class="flex items-center gap-2 text-gray-300"><svg class="h-4 w-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/><polyline points="7 10 12 15 17 10"/></svg>Kolkata, India</span>
                </div>
                <!-- Logo & Mission -->
                <div class="flex flex-col items-center md:items-start gap-4 mb-8 md:mb-0 md:order-2 order-1">
                    <div class="flex items-center gap-3">
                        <span class="text-3xl font-extrabold bg-gradient-to-r from-emerald-400 to-blue-400 bg-clip-text text-transparent tracking-tight align-middle" style="letter-spacing:0.5px;">ResQWings</span>
                    </div>
                    <div class="w-16 border-b-2 border-emerald-500 rounded-full opacity-60 my-1"></div>
                    <p class="text-gray-400 text-sm mt-1 max-w-xs leading-relaxed">Empowering autonomous search and rescue with AI-driven drone swarms. Coordinating, scanning, and saving lives with technology and teamwork.</p>
                </div>
                <!-- Social & Back to Top -->
                <div class="flex flex-col gap-4 items-center md:items-end min-w-[160px]">
                    <span class="text-emerald-400 font-bold uppercase tracking-wide mb-2 text-xs">Connect</span>
                    <div class="flex gap-4">
                        <a href="https://github.com/opkrn/RESQWINGS" target="_blank" rel="noopener" class="text-gray-400 hover:text-emerald-400 transition" title="GitHub">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7" fill="currentColor" viewBox="0 0 24 24"><path d="M12 .5C5.73.5.5 5.73.5 12c0 5.08 3.29 9.39 7.86 10.91.58.11.79-.25.79-.56 0-.28-.01-1.02-.02-2-3.2.7-3.88-1.54-3.88-1.54-.53-1.34-1.3-1.7-1.3-1.7-1.06-.72.08-.71.08-.71 1.17.08 1.78 1.2 1.78 1.2 1.04 1.78 2.73 1.27 3.4.97.11-.75.41-1.27.74-1.56-2.56-.29-5.26-1.28-5.26-5.7 0-1.26.45-2.29 1.19-3.1-.12-.29-.52-1.46.11-3.05 0 0 .98-.31 3.2 1.18a11.1 11.1 0 0 1 2.92-.39c.99 0 1.99.13 2.92.39 2.22-1.49 3.2-1.18 3.2-1.18.63 1.59.23 2.76.11 3.05.74.81 1.19 1.84 1.19 3.1 0 4.43-2.7 5.41-5.27 5.7.42.36.79 1.09.79 2.2 0 1.59-.01 2.87-.01 3.26 0 .31.21.68.8.56C20.71 21.39 24 17.08 24 12c0-6.27-5.23-11.5-12-11.5z"/></svg>
                        </a>
                        <a href="https://linkedin.com/company/resqwings" target="_blank" rel="noopener" class="text-gray-400 hover:text-emerald-400 transition" title="LinkedIn">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7" fill="currentColor" viewBox="0 0 24 24"><path d="M19 0h-14c-2.76 0-5 2.24-5 5v14c0 2.76 2.24 5 5 5h14c2.76 0 5-2.24 5-5v-14c0-2.76-2.24-5-5-5zm-11 19h-3v-10h3v10zm-1.5-11.28c-.97 0-1.75-.79-1.75-1.75s.78-1.75 1.75-1.75 1.75.79 1.75 1.75-.78 1.75-1.75 1.75zm15.5 11.28h-3v-5.6c0-1.34-.03-3.07-1.87-3.07-1.87 0-2.16 1.46-2.16 2.97v5.7h-3v-10h2.88v1.36h.04c.4-.75 1.38-1.54 2.84-1.54 3.04 0 3.6 2 3.6 4.59v5.59zm-12.5-10.28c-.97 0-1.75-.79-1.75-1.75s.78-1.75 1.75-1.75 1.75.79 1.75 1.75-.78 1.75-1.75 1.75z"/></svg>
                        </a>
                        <a href="https://twitter.com/resqwings" target="_blank" rel="noopener" class="text-gray-400 hover:text-emerald-400 transition" title="Twitter">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7" fill="currentColor" viewBox="0 0 24 24"><path d="M24 4.557a9.93 9.93 0 0 1-2.828.775 4.932 4.932 0 0 0 2.165-2.724c-.951.564-2.005.974-3.127 1.195a4.92 4.92 0 0 0-8.384 4.482C7.691 8.095 4.066 6.13 1.64 3.161c-.542.929-.855 2.01-.855 3.17 0 2.188 1.115 4.116 2.823 5.247a4.904 4.904 0 0 1-2.229-.616c-.054 2.281 1.581 4.415 3.949 4.89a4.936 4.936 0 0 1-2.224.084c.627 1.956 2.444 3.377 4.6 3.417A9.867 9.867 0 0 1 0 21.543a13.94 13.94 0 0 0 7.548 2.209c9.057 0 14.009-7.496 14.009-13.986 0-.213-.005-.425-.014-.636A9.936 9.936 0 0 0 24 4.557z"/></svg>
                        </a>
                    </div>
                    <button onclick="window.scrollTo({top:0,behavior:'smooth'})" class="mt-4 px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg shadow transition focus:outline-none focus:ring-2 focus:ring-emerald-400">Back to Top</button>
                </div>
            </div>
            <div class="text-center text-gray-500 text-xs mt-8 flex flex-col gap-2">
                <span>¬© 2025 Autonomous Swarm Co-ordination Technologies. All rights reserved.</span>
                <span class="font-extrabold text-transparent bg-gradient-to-r from-emerald-400 via-blue-400 to-blue-900 bg-clip-text drop-shadow-lg flex items-center justify-center gap-1 text-base animate-pulse">
                    Made with
                    <svg class="h-5 w-5 text-red-500 mx-1" fill="currentColor" viewBox="0 0 20 20"><path d="M.3172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z"/></svg>
                    by solvheXa Team
                </span>
            </div>
        </footer>
</body>

</html>